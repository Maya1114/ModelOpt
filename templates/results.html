{% extends "base.html" %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-10">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h3 class="mb-0">Optimization Complete! ðŸŽ‰</h3>
            </div>
            <div class="card-body">
                <div class="alert alert-success" role="alert">
                    <h5 class="alert-heading">Best Model: {{ best_model }}</h5>
                    <p class="mb-0">Your data has been processed and the best performing algorithm has been selected.</p>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        <h6>Dataset Info:</h6>
                        <ul>
                            <li><strong>Shape:</strong> {{ data_info.shape[0] }} rows Ã— {{ data_info.shape[1] }} columns</li>
                            <li><strong>Target Column:</strong> {{ data_info.target }}</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>Best Model Performance:</h6>
                        <p class="h4 text-success">{{ "%.1f"|format(results[best_model].score * 100) }}% {{ results[best_model].metric }}</p>
                    </div>
                </div>

                <h5>Model Comparison</h5>
                <div class="table-responsive results-table">
                    <table class="table table-striped">
                        <thead class="table-dark">
                            <tr>
                                <th>Algorithm</th>
                                <th>Score</th>
                                <th>Performance</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for model_name, result in results.items() %}
                            <tr {% if model_name == best_model %}class="best-model"{% endif %}>
                                <td>
                                    <strong>{{ model_name }}</strong>
                                    {% if model_name == best_model %}
                                        <span class="badge bg-success ms-2">Best</span>
                                    {% endif %}
                                </td>
                                <td>{{ "%.3f"|format(result.score) }}</td>
                                <td>
                                    <div class="progress" style="height: 20px;">
                                        <div class="progress-bar {% if model_name == best_model %}bg-success{% else %}bg-primary{% endif %}" 
                                             role="progressbar" 
                                             style="width: {{ result.score * 100 }}%"
                                             aria-valuenow="{{ result.score * 100 }}" 
                                             aria-valuemin="0" 
                                             aria-valuemax="100">
                                            {{ "%.1f"|format(result.score * 100) }}%
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <div class="d-grid gap-2 d-md-flex justify-content-md-center mt-4">
                    <a href="{{ url_for('download_model', filename=model_filename) }}" 
                       class="btn btn-success btn-lg me-md-2">
                        ðŸ“¥ Download Best Model
                    </a>
                    <a href="{{ url_for('index') }}" class="btn btn-primary btn-lg">
                        ðŸ”„ Try Another Dataset
                    </a>
                </div>

                <hr class="my-4">
                
                <div class="alert alert-info" role="alert">
                    <h6><strong>What's Next?</strong></h6>
                    <ul class="mb-0">
                        <li>Download your trained model file ({{ model_filename }})</li>
                        <li>Use the model in Python with: <code>pickle.load(open('{{ model_filename }}', 'rb'))</code></li>
                        <li>The model is ready to make predictions on new data with the same format</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}